# 実装レビュアー共通ガイドライン

> **参照元**: 各レビュアーエージェント（backend, frontend, database, security, infra）の共通パターン

---

## 共通設定

### Frontmatter テンプレート

```yaml
---
model: google/antigravity-gemini-3-pro-high
mode: subagent
temperature: 0.2
tools:
  read: true
  glob: true
  grep: true
  mcp__container-use__environment_file_read: true
  mcp__container-use__environment_file_list: true
  write: false
  edit: false
  bash: false
---
```

---

## 共通動作モード

全てのレビュアーは**2つのモード**で動作する。入力に応じて自動的に切り替える。

| モード | 対象 | 目的 |
|-------|------|------|
| **Mode A: 設計レビュー** | `*設計書.md` | 設計フェーズでの品質保証 |
| **Mode B: 実装レビュー** | ソースコード、Git Diff | 実装コードの品質保証 |

---

## 共通出力形式

```markdown
## {専門領域}実装レビュー結果

### 専門家: {ペルソナ名}
### スコア: X/10点

### 各項目の評価
| 項目 | スコア | 詳細 |
|------|--------|------|
| {観点1} | 0-N | ... |
| {観点2} | 0-N | ... |
| ... | ... | ... |

### 指摘事項（修正必須）
1. [ファイル名] 行番号付近: 指摘内容
   - 問題: 
   - 修正案: 
   - 理由: 

### 提案（任意）
- ...

### 判定
[PASS / FAIL] (9点以上で合格)
```

---

## スコアリング基準

### 配点ガイドライン

| 合計点 | 領域数 | 推奨配点例 |
|--------|--------|-----------|
| 10点 | 4領域 | 3+3+2+2 または 3+2+3+2 |
| 10点 | 5領域 | 2+2+2+2+2 |

### 判定基準

| スコア | 判定 | アクション |
|--------|------|----------|
| 9-10点 | PASS | PR作成可能 |
| 7-8点 | FAIL (軽微) | 指摘修正後に再レビュー |
| 0-6点 | FAIL (重大) | 大幅な修正が必要 |

---

## 指摘の書き方

### 良い指摘例

```markdown
1. [src/auth/service.ts] 45行目付近: 認証トークンの検証漏れ
   - 問題: JWTトークンの有効期限チェックが実装されていない
   - 修正案: `jwt.verify()` に `maxAge` オプションを追加
   - 理由: 期限切れトークンでのアクセスを許可してしまうセキュリティリスク
```

### 悪い指摘例

```markdown
1. 認証の実装が不十分  ← 曖昧、どこを直すか不明
```

---

## レビュー時の心構え

1. **建設的**: 問題だけでなく、修正案を必ず提示
2. **具体的**: ファイル名、行番号、コード例を含める
3. **優先度明示**: 修正必須と任意提案を区別
4. **一貫性**: プロジェクトの既存パターンを尊重
